<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>{{ document.title }}</title>
</head>
<body>

<h1>{{ document.title }}</h1>

<!-- ========================= -->
<!-- Intent ç·¨é›† -->
<!-- ========================= -->
<h2>ä½œè€…ã®æ„å›³ï¼ˆIntentï¼‰</h2>

<form method="post" action="/document/{{ document.id }}/intent">

  <label>ã‚¸ãƒ£ãƒ³ãƒ«</label><br>
  <input type="text" name="genre"
         value="{{ document.intent.genre if document.intent else '' }}"
         style="width:100%"><br><br>

  <label>ãƒ†ãƒ¼ãƒãƒ»ä¸»å¼µ</label><br>
  <textarea name="theme_or_claim" rows="2" style="width:100%">{{ document.intent.theme_or_claim if document.intent else '' }}</textarea><br><br>

  <label>ä¾¡å€¤è¦³ãƒ»è‚¯å®šã™ã‚‹ã‚‚ã®</label><br>
  <textarea name="core_values" rows="3" style="width:100%">{{ document.intent.core_values if document.intent else '' }}</textarea><br><br>

  <label>åˆ¶ç´„æ¡ä»¶ï¼ˆ1è¡Œï¼1åˆ¶ç´„ï¼‰</label><br>
  <textarea name="constraints" rows="4" style="width:100%">{% if document.intent %}{{ document.intent.constraints | join('\n') }}{% endif %}</textarea><br><br>

  <button type="submit">Intentã‚’ä¿å­˜</button>
</form>

<hr>

<!-- ========================= -->
<!-- Unit ç·¨é›† -->
<!-- ========================= -->
<form method="post" action="/document/{{ document.id }}">

{% for unit in document.units %}

  <hr>
  <h3>{{ unit.title }}</h3>

  {% if unit._score %}
    <div style="font-size:0.9em; margin-bottom:6px;">
      Intentæ•´åˆ:
      <b style="color: {{ unit._score.intent_color }};">
        {{ unit._score.intent }}
      </b>

      {% if unit._score.prev is not none %}
        ï½œå‰ã¨ã®æ¥ç¶š:
        <b style="color: {{ unit._score.prev_color }};">
          {{ unit._score.prev }}
        </b>
      {% endif %}

      {% if unit._score.next is not none %}
        ï½œæ¬¡ã¨ã®æ¥ç¶š:
        <b style="color: {{ unit._score.next_color }};">
          {{ unit._score.next }}
        </b>
      {% endif %}
    </div>

    {% if unit._score.intent_color == "red" %}
      <form method="post"
            action="/document/{{ document.id }}/improve/{{ loop.index0 }}">
        <button type="submit" style="color:red;">
          ğŸ”´ ã“ã®ã‚·ãƒ¼ãƒ³ã‚’æ”¹å–„ã•ã›ã‚‹
        </button>
      </form>
    {% endif %}
  {% endif %}

  <textarea
      name="unit_{{ loop.index0 }}"
      rows="6"
      cols="100"
  >{{ unit.content }}</textarea>

{% endfor %}

<br><br>
<button type="submit">ä¿å­˜</button>
</form>

<hr>

<form method="post" action="/document/{{ document.id }}/optimize">
  <button type="submit">æ§‹æˆã‚’æœ€é©åŒ–</button>
</form>

<p><a href="/dashboard">â† ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸</a></p>

</body>
</html>
